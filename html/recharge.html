<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>会员充值</title>
    <link rel="stylesheet" href="../css/weui-min.css"/>
    <link rel="stylesheet" href="../css/example.css"/>
    <link rel="stylesheet" type="text/css" href="../css/overlay.css">
    <link rel="stylesheet" href="../css/global.css"/>
    <link rel="stylesheet" type="text/css" href="../vendor/iview/dist/styles/iview.css">
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
            background-color: white;
        }

        .row {
            display: flex;
            width: 50%;
            float: left;
        }

        .box {
            flex: 0 0 48%;
            margin: 1%;
            height: 100px;
            border-radius: 10px;
            align-items: center;
            justify-content: center;
            display: flex;
            position: relative;
            border: 1px black solid;
            color: black;
        }

        .choosen-box {
            flex: 0 0 48%;
            margin: 1%;
            height: 100px;
            border-radius: 10px;
            align-items: center;
            justify-content: center;
            display: flex;
            position: relative;
            color: #00e4e6;
            border: 1px #00e4e6 solid
        }
        .ivu-select-selection{
            border: none;
            outline: none;
        }
        .ivu-select-selection{
            outline: none;
            border: none;
        }

        .ivu-select .ivu-icon, .ivu-icon-ios-arrow-down, .ivu-select-arrow:before {
            display: none;
        }

        .ivu-select .ivu-icon .ivu-select-arrow:before {
            content: none;
        }

        @media only screen and (max-width: 768px) {
            .row {
                width: 100%
            }

            .box {
                flex: 0 0 31%;
                height: 60px;
                border-radius: 3px;
                border: 1px #1aad19 solid;
                color: #1aad19;
            }

            .choosen-box {
                flex: 0 0 31%;
                height: 60px;
                border-radius: 3px;
            }
        }
    </style>
</head>

<body>
<div id='app' style="width:100%;height:100%">
    <div style="margin-top:-5px;text-align: center;padding-top:32px;padding-bottom:10px;line-height: 1.6;background-image: url(../src/background.png);background-repeat: no-repeat">
        <!--<h1 style="font-size: 1.6em;margin: 5px" v-text="name"></h1>-->
        <h2 style="font-size: 1.1em;background: transparent">本帐号余额</h2>
        <h1 style="font-size: 30px;color: #fe736c;background: transparent" v-text="'￥'+cash"></h1>
    </div>
    <row>
        <i-select v-model="model1" style="width: 94%;margin-left: 3%;margin-top: 20px;margin-bottom: 20px;border: 1px #e0ebeb solid"
                  size="large" placeholder="请选择本次充值的技师">
            <i-option v-for="item in jishi" :value="item.value" :key="item.value">{{ item.label }}</i-option>
        </i-select>
    </row>
    <div class="row">
        <!--<div v-for="(val, index) in [100,200,500]" @click="choose(index)"-->
        <!--v-bind:class="{box:box_list[index]==0,'choosen-box':box_list[index]==1}" v-text="val"-->
        <!--style="font-size: 20px">-->
        <!--<span>返还100</span>-->
        <!--</div>-->
        <!--<div class="row">-->
            <!--<div v-for="(val, index) in ['￥1000',2000,5000]" @click="choose(index+3)"-->
                 <!--:class="{box:box_list[index+3]==0,'choosen-box':box_list[index+3]==1}" v-text="val"-->
                 <!--style="font-size: 20px"></div>-->
        <!--</div>-->
        <!--<div class="row">-->
            <!--<div v-for="(val, index) in [10000,20000,'30000']" @click="choose(index+6)"-->
                 <!--:class="{box:box_list[index+6]==0,'choosen-box':box_list[index+6]==1}" v-text="val"-->
                 <!--style="font-size: 20px;margin-bottom: 15px"></div>-->
            <!--&lt;!&ndash; <input type="text" placeholder="自定义" style="border: none;height: 80%;outline: none;text-align: center;width: 50px"></div> &ndash;&gt;-->
        <!--</div>-->






        <!--修改了原来的dom结构,原来的被注释掉了（上面那一坨），10/17/16:40-->






        <div class="box" style="font-size: 20px;">
            <span style="margin-bottom: 10px">￥100</span>
            <span style="font-size: 10px;position: absolute;margin-top: 15px;color:#1aad19 ">返还:￥100</span>
        </div>
        <div class="box" style="font-size: 20px">
            <span style="margin-bottom: 10px">￥200</span>
            <span style="font-size: 10px;position: absolute;margin-top: 15px;color:#1aad19">返还:￥200</span>
        </div>
        <div class="box" style="font-size: 20px">
            <span style="margin-bottom: 10px">￥500</span>
            <span style="font-size: 10px;position: absolute;margin-top: 15px;color:#1aad19">返还:￥500</span>
        </div>
    </div>
    <div class="row">
        <div class="box" style="font-size: 20px;">
            <span style="margin-bottom: 10px">￥1000</span>
            <span style="font-size: 10px;position: absolute;margin-top: 15px;color:#1aad19 ">返还:￥1000</span>
        </div>
        <div class="box" style="font-size: 20px">
            <span style="margin-bottom: 10px">￥2000</span>
            <span style="font-size: 10px;position: absolute;margin-top: 15px;color:#1aad19">返还:￥2000</span>
        </div>
        <div class="box" style="font-size: 20px">
            <span style="margin-bottom: 10px">￥5000</span>
            <span style="font-size: 10px;position: absolute;margin-top: 15px;color:#1aad19">返还:￥5000</span>
        </div>
    </div>
    <div class="row">
        <div class="box" style="font-size: 20px;">
            <span style="margin-bottom: 10px">￥10000</span>
            <span style="font-size: 10px;position: absolute;margin-top: 15px;color:#1aad19 ">返还:￥10000</span>
        </div>
        <div class="box" style="font-size: 20px">
            <span style="margin-bottom: 10px">￥20000</span>
            <span style="font-size: 10px;position: absolute;margin-top: 15px;color:#1aad19">返还:￥20000</span>
        </div>
        <div class="box" style="font-size: 20px">
            <span style="margin-bottom: 10px">￥50000</span>
            <span style="font-size: 10px;position: absolute;margin-top: 15px;color:#1aad19">返还:￥50000</span>
        </div>
    </div>







    <!--修改结束，10/17/16:40-->





    <div class="weui-cells__title" v-on:click="userxuanzejine()">更多金额</div>
    <div class="weui-cells" v-if="xuanzejine">
        <div class="weui-cell weui-cell_swiped">
            <div class="weui-cell__bd">
                <div class="weui-cell">
                    <input type="text" type="number"
                           style="width: 94%;height: 38px;margin-left: 3%;outline: none;padding-left: 10px;border: 1px #e0ebeb solid"
                           placeholder="手动输入充值金额">
                </div>
            </div>
        </div>
    </div>
    <div class="weui-cells__title">本次优惠</div>
    <div class="weui-cells">
        <div class="weui-cell weui-cell_swiped">
            <div class="weui-cell__bd" style="transform: translateX(-68px)">
                <div class="weui-cell" onclick="navi('recharge.html')">
                    <div class="weui-cell__bd">
                        <p style="margin-left: 20%">
                            <span style="display:inline-block ;width:40px">会员</span>
                            <span style="display:inline-block ;font-family: 华文雅黑;background-color: #fe736c;color: white;border-radius: 6px;padding: 0 2px;font-size: 15px">
                                    充返
                                </span>
                            <span style="display:inline-block;font-size: 13px;font-weight: 100;color: gray;">充500送500，充1000送2000</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div style="position: fixed;bottom: 20px;width: 100%;height: 40px;">
        <button @click="recharge()"
                style="width: 94%;margin-left: 3%;height: 40px;border-radius: 15px;background-color: #00e4e6;border: none;color: white">
            确认充值
        </button>
    </div>
    <div id="modal-overlay" v-show="overlay">
        <div class="modal-data">
            <img src="../src/loading.gif"/>
        </div>
    </div>
</div>
</body>
<script type="text/javascript" src="../js/jweixin.js"></script>
<script type="text/javascript" src="../js/example.js"></script>
<script type="text/javascript" src="../js/weui-min.js"></script>
<script type="text/javascript" src="../js/zepto.js"></script>
<script type="text/javascript" src="../js/jquery.js"></script>
<script type="text/javascript" src="../js/sweetalert2.all.js"></script>
<script type="text/javascript" src="../js/echarts-simple-min.js"></script>
<script src="../js/vue.js"></script>
<script type="text/javascript" src="../js/windowOpen.js"></script>
<script type="text/javascript" src="../vendor/iview/dist/iview.min.js"></script>
<script>
    /**









     注意，大约在160行左右的post数据进行充值，user_id将在日后通过微信接口获得，目前只是静态数据，记得修改










     */
    let app = new Vue({
        el: "#app",
        data: {
            xuanzejine: false,
            jishi: [
                {
                    value: 'AKB48',
                    label: 'AKB48'
                },
                {
                    value: 'NNK43',
                    label: 'NNK43'
                },
                {
                    value: 'KJKF39',
                    label: 'KJKF39'
                },
                {
                    value: 'FEFE343',
                    label: 'FEFE343'
                },
                {
                    value: 'EDEF67',
                    label: 'EDEF67'
                },
                {
                    value: 'FER67',
                    label: 'FER67'
                }
            ],
            model1: '',
            name: "",
            cash: 0,
            job_number: "",
            pay: 0,
            overlay: true,
            box_list: [
                0, 0, 0,
                0, 0, 0,
                0, 0, 0,
            ],
            fee_list: [
                100, 200, 500,
                1000, 2000, 5000,
                10000, 20000, '自定义'
            ],
            fee: 0,
        },
        methods: {
            userxuanzejine() {
                this.xuanzejine = !this.xuanzejine;
            },
            choose(idx) {
                var that = this;
                for (var i = 0; i < that.box_list.length; i++) {
                    if (i == idx) {
                        //不能直接赋值，vue无法通过数组索引的方式检测到数据变化，必须用Vue.set来改变数据
                        Vue.set(that.box_list, i, 1)//that.box_list[i] = 1;
                        that.fee = that.fee_list[i];
                    } else {
                        Vue.set(that.box_list, i, 0)//that.box_list[i] = 0;
                    }
                }
            },
            recharge() {
                var that = this;
                if (this.fee == 0 || this.fee == '自定义') {
                    $(that).openWindow("注意", "请选择充值金额", ['好的']);
                } else {
                    $.post('../php/recharge.php', {
                        charge: that.fee,
                        user_id: "test",
                        job_number: that.job_number,
                        pay: that.pay
                    }).done((res) => {
                        res = JSON.parse(res);
                        if (res.status == 1) {
                            $(that).openWindow("", "充值成功", ['好的'], () => {
                                window.location.href = "index.html";
                            })
                        }
                    })
                }
            }
        },
        created() {
            var that = this
            $.post("../php/getcustomer.php", {
                phone: "13777579230"
            }).done((res) => {
                res = JSON.parse(res);
                if (res.status == 1) {
                    that.name = res.name;
                    that.cash = res.cash;
                    that.overlay = false;
                }
            })
        },
    })
</script>

</html>